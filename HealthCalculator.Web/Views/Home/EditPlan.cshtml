
@{
    ViewBag.Title = "Edit Plan";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="bg-yellow">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col">
                <ul class="list-inline menu-sec">
                    <li class="list-inline-item"><a href="~/Home/AdminView">Back To Admin View</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>
<div class="container-fluid flowerBg">
    <div class="row justify-content-center">
        <div class="col-12 col-md-12 col-lg-11">
            <div class="middleContent bg-gray shadow">
                <div class="row">
                    <div class="col-12 col-md-12">
                        <p class="semi mb-2 text-yellow">Edit  Plan</p>
                        <hr class="mt-0 mb-4 bg-dark" />
                        <input type="hidden" id="hdnOrderDetailsID" />
                    </div>
                </div>
                <form class="form-data">
                    <div class="form-group row">
                        <label class="col-12 col-sm-5 col-form-label semi">Program <span class="float-right d-none d-md-block"> : </span></label>
                        <div class="col-12 col-sm-7">
                            <input type="text" class="form-control border mandFree" id="Program"  placeholder="Enter Name" readonly="readonly" />
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-12 col-sm-5 col-form-label semi">Product <span class="float-right d-none d-md-block"> : </span></label>
                        <div class="col-12 col-sm-7">
                            <input type="text" class="form-control border mandFree" id="ProductName"  placeholder="Enter Name" readonly="readonly" />
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-12 col-sm-5 col-form-label semi">Is Payment Done <span class="float-right d-none d-md-block"> : </span></label>
                        <div class="col-12 col-sm-7">
                            <input type="text" class="form-control border" id="IsPaymentDone"   readonly="readonly" />
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-12 col-sm-5 col-form-label semi">Total Days <span class="float-right d-none d-md-block"> : </span></label>
                        <div class="col-12 col-sm-7">
                            <input type="text" class="form-control border mandFree" id="Totaldays" maxlength="100" />
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-12 col-sm-5 col-form-label semi">Do you want to Active/Deactive/Complete the session <span class="float-right d-none d-md-block"> : </span></label>
                        <div class="col-12 col-sm-7">
                            <select class="custom-select mandFree" id="ActivePlan">
                                <option value="" selected>Select</option>
                                <option value="Yes">Active</option>
                                <option value="No">Deactive</option>
                                <option value="NA">Completed</option>
                            </select>
                        </div>
                    </div>                    
                    <div class="form-group row">
                        <label class="col-12 col-sm-5 col-form-label semi">Active Start Data <span class="float-right d-none d-md-block"> : </span></label>
                        <div class="col-12 col-sm-7">
                            <input type="date" class="form-control border mandFree" id="StartActiveDate" maxlength="100" placeholder="Enter Start date">
                        </div>
                    </div>
                    <div class="form-group row" style="display:none;">
                        <label class="col-12 col-sm-5 col-form-label semi">Active End Date <span class="float-right d-none d-md-block"> : </span></label>
                        <div class="col-12 col-sm-7">
                            <input type="date" class="form-control border" id="EndActiveDate" maxlength="100" placeholder="Enter end date">
                        </div>
                    </div>
                    
                    <div class="form-group row">
                        <div class="col-12 col-sm-12 text-right">
                            <a class="btn btn-reg mb-4 hvr-sweep-to-top"  onclick="UpdatePlan()">&nbsp; &nbsp; SUBMIT &nbsp; &nbsp; </a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<script>
    function ValidateRequiredField() {

        var isRequired = true;
        var x = document.getElementsByClassName("mandFree");
        var i;
        for (i = 0; i < x.length; i++) {

            if (x[i].value == "") {
                isRequired = false;
            }
        }
        return isRequired;
    }
    window.onload = function () {
        var qData = "@Request.QueryString["orderId"].ToString()";    
        
        $("#hdnOrderDetailsID").val(qData);

        var selectedUserId = sessionStorage.getItem('SelectedUserId');
        if (selectedUserId != "") {
            sessionStorage.setItem('userId', selectedUserId);
        }
        CommonAjaxMethod('Home/GetUserPlanOrderDetails', {OrderdetailID:qData, userId: sessionStorage.getItem('userId') }, false, 'GET', function (response) 
        {
            $("#Program").val(response.dataCollection[0].Program);
            $("#ProductName").val(response.dataCollection[0].ProductName);
            $("#StartActiveDate").val(response.dataCollection[0].StartActiveDate);
            $("#EndActiveDate").val(response.dataCollection[0].EndActiveDate); 
            $("#Totaldays").val(response.dataCollection[0].Totaldays);
            $("#ActivePlan").val(response.dataCollection[0].ActivePlan);
            $("#IsPaymentDone").val(response.dataCollection[0].IsPaymentDone);       
        });
    }


    function UpdatePlan() {
        var objData = {
            OrderDetail_Id: $("#hdnOrderDetailsID").val(),
            Program: $("#Program").val(),
            ProductName: $("#ProductName").val(),
            StartActiveDate: $("#StartActiveDate").val(),
            EndActiveDate: $("#EndActiveDate").val(),   
            Totaldays: $("#Totaldays").val(),
            ActivePlan: $("#ActivePlan").val(),
            IsPaymentDone: $("#IsPaymentDone").val()
        }
        if (ValidateRequiredField()) {
            CommonAjaxMethod('Home/SaveOrderDetails', objData, false, 'POST', function (response) {
                alert("Plan updated successfully.");
            });
        }
        else
        {
            alert("Plan select mandotory details.");
            return false;
        }
    }
</script>

