
@{
    ViewBag.Title = "tracker";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container-fluid bg-sky">
    <div class="row">
        <div class="col-12 col-md-12 col-lg-12 text-center pt-3 pb-2">
            <input type="hidden" id="hdnLoginUserId" />
            <h2 class="semi text-white text-shadow">
                <span class="mb-2 dib">ACCOUNT SECTION</span></br>
                <span id="HeaderValue"></span> believe in yourself. You can do it!
                <img src="@CommonMethods.ServerPath/img/smiley.png" class="smiley" style="width: 40px;margin-top: 4px;" />
                <img src="@CommonMethods.ServerPath/img/thumbs.png" style="width: 40px; vertical-align: middle;" />
            </h2>
        </div>
    </div>
</div>

<div class="bg-yellow">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col">
                <ul class="list-inline menu-sec">

                    <li class="list-inline-item"><a href="#" onclick="Assessment(this)">My Assessment Tool</a></li>

                    <li class="list-inline-item"> <a href="#" onclick="TrackersHelp(this)">My Trackers<span class="float-right     d-md-block font" style="color: red;" id="spTrackers"></span></a></li>

                    <li class="list-inline-item"><a href="#" onclick="MyEatingSmartTools(this)">My Eating Smart Tool</a></li>


                    <li class="list-inline-item"> <a href="#" onclick="PatternHelp(this)">My Eating Pattern<span class="float-right   d-md-block" style="color: red;" id="spPattern"></span></a></li>

                    <li class="list-inline-item"> <a href="#" onclick="MessageHelp(this)">Admin Messages<span class="float-right   d-md-block" style="color: red;" id="spMessage"></span></a></li>

                    <li class="list-inline-item"><a href="~/Home/ViewPlan?userId=">View Plans</a></li>
                    <li class="list-inline-item active"><a onclick="Logout(this)">Logout</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="container-fluid flowerBg">
    <div class="row justify-content-center">
        <div class="col-12 col-md-12 col-lg-11">
            <div class="middleContent bg-gray shadow">
                <div class="col-12 col-md-12">
                    <p class="semi mb-2 text-yellow">Program:-<label class="col-12 col-sm-5 col-form-label semi" id="lbllable"></label></p>
                </div>
                <div>
                    <div class="row">
                        <div class="col-12 col-md-12">
                                                        
                                <p class="semi mb-2 text-yellow">WEIGHT TRACKER</p>
                                <div class="row">
                                    <div class="col-12 col-sm-6 col-md-4">
                                        <div class="form-group">
                                            <select class="custom-select" id="ddlWeight">
                                                <option selected>Select</option>
                                                <option value="KG">KG</option>
                                                <option value="LB">LB</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                           
                        </div>
                    </div>
                    </div>

                <div style="overflow-x:scroll">
                    <table class="table" id="tblWeight">
                        <thead>
                            <tr bgcolor="#f4a800">
                                <th class="semi mb-2 text-white">Date </th>
                                <th class="semi mb-2 text-white" style="width:25px;">Session </th>
                                <th class="semi mb-2 text-white"> </th>
                                <th class="semi mb-2 text-white">Weight </th>
                                <th class="semi mb-2 text-white">Difference </th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <div>
                    <div class="row">
                        <div class="col-12 col-md-12">
                            <p class="semi mb-2 text-yellow">INCH TRACKER</p>
                            <div class="row">
                                <div class="col-12 col-sm-6 col-md-4">
                                    <div class="form-group">
                                        <select class="custom-select" id="ddlInch">
                                            <option selected>Select</option>
                                            <option value="Inch">Inch</option>
                                            <option value="CM">CM</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>

                    <div style="overflow-x:scroll">
                        <table class="table" id="tblInch">
                            <thead>
                                <tr bgcolor="#f4a800">
                                    <th class="semi mb-2 text-white">Date </th>
                                    <th class="semi mb-2 text-white" style="width:25px;">Session </th>
                                    <th class="semi mb-2 text-white"> </th>
                                    <th class="semi mb-2 text-white">Chest </th>
                                    <th class="semi mb-2 text-white">Waist </th>
                                    <th class="semi mb-2 text-white">Hip </th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>

                    </div>
                </div>
             
                <div class="row">
                    <div class="col-12 text-right">
                        <a class="btn btn-reg mb-2 hvr-sweep-to-top" id="btnSubmit" onclick="SaveTracker()">&nbsp; &nbsp; SUBMIT &nbsp; &nbsp; </a>
                    </div>

                    <div>
                        <input type="hidden" id="hdnProductId" />
                        <input type="hidden" id="hdnOrderId" />
                        <input type="hidden" id="hdnlenght" />
                        <input type="hidden" id="hdnIlenght" />
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="~/js/jquery-3.5.1.min.js"></script>
<script type="text/javascript">
     function Assessment(ctrl)
    {
        @*//var selectedUserId = "@Request.QueryString["userId"].ToString()";*@
        var selectedUserId = "@Request.QueryString["userId"]";
        if (selectedUserId != "") {
            sessionStorage.setItem('userId', selectedUserId);
        }
        else { selectedUserId = sessionStorage.getItem('userId') }

        ctrl.href = '@Url.Content("~/Home/assessment?userId=")' + selectedUserId;
        ctrl.click();
    }
   function MessageHelp(ctrl) {
        var selectedUserId = "@Request.QueryString["userId"].ToString()";
        if (selectedUserId != "") {
            sessionStorage.setItem('userId', selectedUserId);
        }
        ctrl.href = '@Url.Content("~/Home/helpDesk?userId=")' + selectedUserId;
        ctrl.click();
    }
    function TrackersHelp(ctrl)
    {
        var selectedUserId = "@Request.QueryString["userId"].ToString()";
        if (selectedUserId != "") {
            sessionStorage.setItem('userId', selectedUserId);
        }
        ctrl.href = '@Url.Content("~/Home/tracker?userId=")' + selectedUserId;
        ctrl.click();
    }
    function PatternHelp(ctrl)
    {
        var selectedUserId = "@Request.QueryString["userId"].ToString()";
        if (selectedUserId != "") {
            sessionStorage.setItem('userId', selectedUserId);
        }
        ctrl.href = '@Url.Content("~/Home/MyEatingPattern?userId=")' + selectedUserId;
        ctrl.click();
    }

       function Logout(ctrl) {
        sessionStorage.clear();
        ctrl.href = '@Url.Content("~/Home/Logout")';
        ctrl.click();
    }

    $(document).ready(function ()
    {
        var qData = "@Request.QueryString["userId"].ToString()";

        if (qData != "")
        {

            qData = "@Request.QueryString["userId"].ToString()";
            sessionStorage.setItem('userId', qData);

        }
        if (sessionStorage.getItem('RoleID') == "1") {
            var obj2 = {

                Module: "3"
            }
            CommonAjaxMethod('Program/SaveUserNotification', obj2, false, 'POST', function (response) {

            });
        }
        if (sessionStorage.getItem('RoleID') == "3") {
            var obj1 = {

                Type: "3",
                OperationType: "UPDATE",
                UserId: qData
            }
            CommonAjaxMethod('Home/AdminNotificationEnquiryMessage', obj1, false, 'POST', function (response) {

            });
        }
        var UserNotification =
          {
              TableType: "GetRecord",
              UserId: sessionStorage.getItem('userId')
          }
        CommonAjaxMethod('Program/GetUserNotification', UserNotification, false, 'POST', function (response) {

            if (response.data.Data.length > 0) {
                $("#spMessage").text(" (" + response.data.Data[0].MessageCount + ")");
                if (response.data.Data[0].Trackerfalldays != "0") {
                    $("#spTrackers").text(" (" + response.data.Data[0].Trackerfalldays + ")");
                }
                else {
                    $("#spTrackers").text(" (" + response.data.Data[0].Trackerfilled + ")");
                }
                $("#spPattern").text(" (" + response.data.Data[0].PatternCount + ")");
            }

        });

       CommonAjaxMethod('Home/GetUserDetailsById', { userId: sessionStorage.getItem('userId') }, false, 'GET', function (response) {
           $("#HeaderValue").text(response.dataCollection[0].FirstName + ",");

       });


        var tracker =
        {
            TableType: "GetRecord",
            UserId: sessionStorage.getItem('userId')
        }
        CommonAjaxMethod('Program/GetUserTrackerDetails', { userId:sessionStorage.getItem('userId')}, false, 'GET', function (response) {

            if (response.data.Data.Table.length> 0)
            {


               // var dateData = new Date(parseInt(dateValue.replace("/Date(", "").replace(")/")));
                var dateData = new Date();
                var dd = dateData.getDate();
                var mm = dateData.getMonth() + 1; //January is 0!
                var yyyy = dateData.getFullYear();
                if (dd < 10) { dd = '0' + dd }
                if (mm < 10) { mm = '0' + mm }
                strDate = yyyy + '-' + mm + '-' + dd;


               // var varsession = response.data.Data[0].GivenDays / 3;
                //alert(varsession);
                var vara = 0;
                var varb = 1;

                $("#hdnProductId").val(response.data.Data.Table[0].ProductId);
                $("#hdnOrderId").val(response.data.Data.Table[0].OrderId);
                $("#hdnlenght").val(response.data.Data.Table.length);
                $("#ddlWeight").val(response.data.Data.Table[0].WeightIn);
                $("#ddlInch").val(response.data.Data.Table1[0].WeightIn);

                $("#hdnIlenght").val(response.data.Data.Table1.length);
                orderID = response.data.Data.Table[0].OrderId;
                $("#lbllable").text(response.data.Data.Table[0].Program + " :: " + response.data.Data.Table[0].ProductName);
                $('#DivDynamicSession').html("");
                var divHTML = "";

                $('#InchDivDynamicSession').html("");
                var InchdivHTML = "";
                $("#tblWeight").find('tbody').html("");
                $("#tblInch").find('tbody').html("");


                var tblWRowsesion = 0;
                var tblIRowsesion = 0;
                var tblWRow = 0;
                var tblWRowStart = 0;
                var tblWRowEnd = 0;
                var tblIRow = 0;
                for (var i = 0; i < response.data.Data.Table.length; i++)
                {
                    if (sessionStorage.getItem('RoleID') == "1")
                    {

                        tblWRow++;
                        var tblrow = "";
                        if (tblWRow == 1)
                        {
                            tblWRowsesion++;
                            tblrow = '<tr>' +
                               '<td>' +
                                   '<input type="date" style="width:200px;" readOnly="true" class="form-control" placeholder="Enter Date" id="txtWDate' + (i + 1) + '"  />' +
                               '</td>' +
                               '<td rowspan="3"   style="vertical-align : middle;text-align:center;background: #32c6c6;"><div style="width:150px;" class="bg-sky text-white h-100">Session ' + tblWRowsesion + '</div></td>' +
                               '<td>Start</td>' +
                               '<td><input type="text"  style="width:100px;"  class="form-control" placeholder="Enter Weight"  id="txtWT' + (i + 1) + '"/></td>' +
                               '<td><input type="text" style="width:100px;" class="form-control" id="txtWD' + (i + 1) + '" placeholder="" readOnly="true" /></td>' +
                           '</tr>';
                        }
                        if (tblWRow == 2) {

                            tblrow = '<tr>' +
                               '<td>' +
                                   '<input type="date" style="width:200px;" readOnly="true" class="form-control" placeholder="Enter Date" id="txtWDate' + (i + 1) + '"  />' +
                               '</td>' +

                               '<td>Mid</td>' +
                               '<td><input type="text" style="width:100px;"  class="form-control" placeholder="Enter Weight"  id="txtWT' + (i + 1) + '"/></td>' +
                               '<td><input type="text" style="width:100px;" class="form-control" id="txtWD' + (i + 1) + '" placeholder="" readOnly="true" /></td>' +
                           '</tr>';
                        }
                        if (tblWRow == 3) {
                            tblrow = '<tr>' +
                               '<td>' +
                                   '<input type="date" style="width:200px;" readOnly="true" class="form-control" placeholder="Enter Date" id="txtWDate' + (i + 1) + '"  />' +
                               '</td>' +

                               '<td>End</td>' +
                               '<td><input type="text" style="width:100px;"   class="form-control" placeholder="Enter Weight"  id="txtWT' + (i + 1) + '"/></td>' +
                               '<td><input type="text" style="width:100px;" class="form-control" id="txtWD' + (i + 1) + '" placeholder="" readOnly="true" /></td>' +
                           '</tr>';
                        }
                        if (tblWRow == 3)
                        {
                            $("#tblWeight").find('tbody').append(tblrow);
                            $("#tblWeight").find('tbody').append('<tr><td colspan="5"><hr class="mt-0 mb-2 bg-dark" /></td> </tr>');
                            tblWRow=0;
                        }
                        else
                        {
                            $("#tblWeight").find('tbody').append(tblrow);
                        }

                    }
                    else {
                        tblWRow++;
                        var tblrow = "";
                        if (tblWRow == 1) {
                            tblWRowsesion++;
                            tblrow = '<tr>' +
                               '<td>' +
                                   '<input type="date" style="width:200px;" class="form-control" placeholder="Enter Date" id="txtWDate' + (i + 1) + '"  />' +
                               '</td>' +
                                '<td rowspan="3"   style="vertical-align : middle;text-align:center;background: #32c6c6;"><div style="width:150px;" class="bg-sky text-white h-100">Session ' + tblWRowsesion + '</div></td>' +
                               '<td>Start</td>' +
                               '<td><input type="text" style="width:100px;"  class="form-control" placeholder="Enter Weight"  id="txtWT' + (i + 1) + '"/></td>' +
                               '<td><input type="text" style="width:100px;" class="form-control" id="txtWD' + (i + 1) + '" placeholder="" readOnly="true" /></td>' +
                           '</tr>';
                        }
                        if (tblWRow == 2) {

                            tblrow = '<tr>' +
                               '<td>' +
                                   '<input type="date" style="width:200px;" class="form-control" placeholder="Enter Date" id="txtWDate' + (i + 1) + '"  />' +
                               '</td>' +

                               '<td>Mid</td>' +
                               '<td><input type="text" style="width:100px;"  class="form-control" placeholder="Enter Weight"  id="txtWT' + (i + 1) + '"/></td>' +
                               '<td><input type="text" style="width:100px;" class="form-control" id="txtWD' + (i + 1) + '" placeholder="" readOnly="true" /></td>' +
                           '</tr>';
                        }
                        if (tblWRow == 3) {
                            tblrow = '<tr>' +
                               '<td>' +
                                   '<input type="date" style="width:200px;" class="form-control" placeholder="Enter Date" id="txtWDate' + (i + 1) + '"  />' +
                               '</td>' +

                               '<td>End</td>' +
                               '<td><input type="text" style="width:100px;"   class="form-control" placeholder="Enter Weight"  id="txtWT' + (i + 1) + '"/></td>' +
                               '<td><input type="text" style="width:100px;" class="form-control" id="txtWD' + (i + 1) + '" placeholder="" readOnly="true" /></td>' +
                           '</tr>';
                        }
                        if (tblWRow == 3) {
                            $("#tblWeight").find('tbody').append(tblrow);
                            $("#tblWeight").find('tbody').append('<tr><td colspan="5"><hr class="mt-0 mb-2 bg-dark" /></td> </tr>');
                            tblWRow = 0;
                        }
                        else {
                            $("#tblWeight").find('tbody').append(tblrow);
                        }
                    }
                }
                for (var i = 0; i < response.data.Data.Table1.length; i++)
                {
                    if (sessionStorage.getItem('RoleID') == "1") {
                        tblIRow++;
                        var tblrowInch = "";
                        if (tblIRow == 1)
                        {
                            tblIRowsesion++;
                            tblrowInch = '<tr>' +
                               '<td>' +
                                   '<input type="date" style="width:200px;" readOnly="true" class="form-control" placeholder="Enter Date" id="txtIDate' + (i + 1) + '"  />' +
                               '</td>' +
                                 '<td rowspan="2"   style="vertical-align : middle;text-align:center;background: #32c6c6;"><div style="width:150px;" class="bg-sky text-white h-100">Session ' + tblIRowsesion + '</div></td>' +

                               '<td>Start</td>' +
                               '<td><input type="text" style="width:100px;"   class="form-control" placeholder="Enter Chest"  id="txtC' + (i + 1) + '"/></td>' +
                                '<td><input type="text" style="width:100px;"  class="form-control" placeholder="Enter Waist"  id="txtW' + (i + 1) + '"/></td>' +
                                '<td><input type="text"  style="width:100px;" class="form-control" placeholder="Enter Hip"  id="txtH' + (i + 1) + '"/></td>' +
                           '</tr>';
                        }
                        if (tblIRow == 2)
                        {
                            tblWRowsesion++;
                            tblrowInch = '<tr>' +
                               '<td>' +
                                   '<input type="date" style="width:200px;" readOnly="true" class="form-control" placeholder="Enter Date" id="txtIDate' + (i + 1) + '"  />' +
                               '</td>' +

                               '<td>End</td>' +
                                '<td><input type="text" style="width:100px;"  class="form-control" placeholder="Enter Chest"  id="txtC' + (i + 1) + '"/></td>' +
                                '<td><input type="text" style="width:100px;"  class="form-control" placeholder="Enter Waist"  id="txtW' + (i + 1) + '"/></td>' +
                                '<td><input type="text" style="width:100px;"  class="form-control" placeholder="Enter Hip"  id="txtH' + (i + 1) + '"/></td>' +
                           '</tr>';
                        }

                        if (tblIRow == 2)
                        {
                            $("#tblInch").find('tbody').append(tblrowInch);
                            $("#tblInch").find('tbody').append('<tr><td colspan="6"><hr class="mt-0 mb-2 bg-dark" /></td> </tr>');
                            tblIRow = 0;
                        }
                        else {
                            $("#tblInch").find('tbody').append(tblrowInch);
                        }
                    }
                    else {
                        tblIRow++;
                        var tblrowInch = "";
                        if (tblIRow == 1) {
                            tblIRowsesion++;
                            tblrowInch = '<tr>' +
                               '<td>' +
                                   '<input type="date" style="width:200px;"  class="form-control" placeholder="Enter Date" id="txtIDate' + (i + 1) + '"  />' +
                               '</td>' +
                            '<td rowspan="2"   style="vertical-align : middle;text-align:center;background: #32c6c6;"><div style="width:150px;" class="bg-sky text-white h-100">Session ' + tblIRowsesion + '</div></td>' +
                               '<td>Start</td>' +
                               '<td><input type="text"  style="width:100px;"  class="form-control" placeholder="Enter Chest"  id="txtC' + (i + 1) + '"/></td>' +
                                '<td><input type="text"  style="width:100px;"  class="form-control" placeholder="Enter Waist"  id="txtW' + (i + 1) + '"/></td>' +
                                '<td><input type="text" style="width:100px;"  class="form-control" placeholder="Enter Hip"  id="txtH' + (i + 1) + '"/></td>' +
                           '</tr>';
                        }
                        if (tblIRow == 2) {
                            tblWRowsesion++;
                            tblrowInch = '<tr>' +
                               '<td>' +
                                   '<input type="date"  style="width:200px;"  class="form-control" placeholder="Enter Date" id="txtIDate' + (i + 1) + '"  />' +
                               '</td>' +
                               '<td>End</td>' +
                                '<td><input type="text" style="width:100px;"  class="form-control" placeholder="Enter Chest"  id="txtC' + (i + 1) + '"/></td>' +
                                '<td><input type="text" style="width:100px;"  class="form-control" placeholder="Enter Waist"  id="txtW' + (i + 1) + '"/></td>' +
                                '<td><input type="text" style="width:100px;"  class="form-control" placeholder="Enter Hip"  id="txtH' + (i + 1) + '"/></td>' +
                           '</tr>';
                        }

                        if (tblIRow == 2) {
                            $("#tblInch").find('tbody').append(tblrowInch);
                            $("#tblInch").find('tbody').append('<tr><td colspan="6"><hr class="mt-0 mb-2 bg-dark" /></td> </tr>');
                            tblIRow = 0;
                        }
                        else {
                            $("#tblInch").find('tbody').append(tblrowInch);
                        }
                    }


                }

                GetTrackerData();
            }

        });





    })


    function getdate(strdate) {
        var strRetrunDate;
        if (strdate != null) {
            var dateData = new Date(parseInt(strdate.replace("/Date(", "").replace(")/")));
            var dd = dateData.getDate();
            var mm = dateData.getMonth() + 1; //January is 0!
            var yyyy = dateData.getFullYear();
            if (dd < 10) { dd = '0' + dd }
            if (mm < 10) { mm = '0' + mm }
            strRetrunDate = yyyy + '-' + mm + '-' + dd;
        }
        return strRetrunDate;
    }
    function getTodaydate() {
        var strRetrunDate;

            var dateData = new Date();
            var dd = dateData.getDate();
            var mm = dateData.getMonth() + 1; //January is 0!
            var yyyy = dateData.getFullYear();
            if (dd < 10) { dd = '0' + dd }
            if (mm < 10) { mm = '0' + mm }
            strRetrunDate = yyyy + '-' + mm + '-' + dd;

        return strRetrunDate;
    }
    function GetTrackerData()
    {
        CommonAjaxMethod('Program/GetUserTrackerDetails', { userId: sessionStorage.getItem('userId') }, false, 'GET',
          function (response) {

              if (response.data.Data.Table.length > 0)
              {

                //  var varlength = response.data.Data.length / 3;

                  for (var i = 0; i < response.data.Data.Table.length; i++)
                  {

                      var isValidDate=false;
                      var strDate = ""; //var dateValue;

                      if (response.data.Data.Table[i].TrackerDate != null)
                      {

                          strDate = getdate(response.data.Data.Table[i].TrackerDate);
                          var todayDate = getTodaydate();
                          if(strDate==todayDate)
                          {
                              isValidDate=true
                          }
                      }



                        if (sessionStorage.getItem('RoleID') == "1")
                            {
                            if (isValidDate)
                            {
                                        $("#txtWT" +( i+1)).val(response.data.Data.Table[i].Weight);
                                        $("#txtWD" +( i+1)).val(response.data.Data.Table[i].WeightDifference);
                                    }
                                    else
                                  {
                                        $("#txtWT" +(i+1)).val(response.data.Data.Table[i].Weight);
                                        $("#txtWD" +(i+1)).val(response.data.Data.Table[i].WeightDifference);
                                        $("#txtWT" +(i+1)).attr('readonly', true);
                                        $("#txtWD" +(i+1)).attr('readonly', true);
                                    }
                        }
                        else
                        {

                            $("#txtWT" + (i+1)).val(response.data.Data.Table[i].Weight);
                            $("#txtWD" + (i+1)).val(response.data.Data.Table[i].WeightDifference);
                             }

                        $("#txtWDate"+ (i + 1)).val(strDate);


                  }




                  for (var i = 0; i < response.data.Data.Table1.length; i++)
                  {

                      var isValidDateI = false;
                      var strDate = ""; //var dateValue;

                      if (response.data.Data.Table1[i].InchTrackerDate != null) {

                          strDate = getdate(response.data.Data.Table1[i].InchTrackerDate);

                         var todayDate = getTodaydate();
                          if (strDate == todayDate) {
                              isValidDateI = true
                          }
                      }



                      if (sessionStorage.getItem('RoleID') == "1")
                      {
                          if (isValidDateI) {
                              $("#txtC" + (i+1)).val(response.data.Data.Table1[i].Chest);
                              $("#txtW" + (i + 1)).val(response.data.Data.Table1[i].Waist);
                              $("#txtH" + (i + 1)).val(response.data.Data.Table1[i].Hip);
                          }
                          else {
                              $("#txtC" + (i + 1)).val(response.data.Data.Table1[i].Chest);
                              $("#txtW" + (i + 1)).val(response.data.Data.Table1[i].Waist);
                              $("#txtH" + (i + 1)).val(response.data.Data.Table1[i].Hip);
                              $("#txtC" + (i + 1)).attr('readonly', true);
                              $("#txtW" + (i + 1)).attr('readonly', true);
                              $("#txtH" + (i + 1)).attr('readonly', true);

                          }
                      }
                      else {

                          $("#txtC" + (i + 1)).val(response.data.Data.Table1[i].Chest);
                          $("#txtW" + (i + 1)).val(response.data.Data.Table1[i].Waist);
                          $("#txtH" + (i + 1)).val(response.data.Data.Table1[i].Hip);
                      }

                      $("#txtIDate"+(i + 1)).val(strDate);
                  }
              }
          }
      );
    }
    function SaveTracker() {


        var mytracker =
        {
            TableType: "Tracker",
            UserId: sessionStorage.getItem('userId'),
            ProductId: $("#hdnProductId").val() == undefined ? '' : $("#hdnProductId").val().trim(),
            OrderId: $("#hdnOrderId").val() == undefined ? 0 : $("#hdnOrderId").val().trim(),
            UserTrackerWeigth: [],
            UserTrackerInch: []

        }



        var varlenght = $("#hdnlenght").val();
        if ($("#hdnlenght").val() != '' || $("#hdnlenght").val())
        {
            // alert($("#hdnlenght").val());
            //
            for (var i = 0; i < parseInt($("#hdnlenght").val()); i++)
            {
               // alert("a");
               //
                var list1 =
                {
                    UserId: sessionStorage.getItem('userId'),
                    ProductId: $("#hdnProductId").val() == undefined ? '' : $("#hdnProductId").val().trim(),
                    OrderId: $("#hdnOrderId").val() == undefined ? 0 : $("#hdnOrderId").val().trim(),
                    WeightIn: $("#ddlWeight").val() == undefined ? 0 : $("#ddlWeight").val().trim(),
                    Weight: $("#txtWT" + (i + 1)).val() == undefined ? 0 : $("#txtWT" + (i + 1)).val().trim(),
                    WeightDifference: $("#txtWD" + (i + 1)).val() == undefined ? 0 : $("#txtWD" + (i + 1)).val().trim(),
                    TrackerDate: $("#txtWDate" + (i + 1)).val() == undefined ? 0 : $("#txtWDate" + (i + 1)).val().trim(),
                }
                mytracker.UserTrackerWeigth.push(list1);

            }

            for (var k = 0; k < parseInt($("#hdnIlenght").val()) ; k++) {
                // alert("a");
                //

                var list1 =
                {
                    UserId: sessionStorage.getItem('userId'),
                    ProductId: $("#hdnProductId").val() == undefined ? '' : $("#hdnProductId").val().trim(),
                    OrderId: $("#hdnOrderId").val() == undefined ? 0 : $("#hdnOrderId").val().trim(),
                    WeightIn: $("#ddlInch").val() == undefined ? 0 : $("#ddlInch").val().trim(),
                    Chest: $("#txtC" + (k + 1)).val() == undefined ? 0 : $("#txtC" + (k + 1)).val().trim(),
                    Waist: $("#txtW" + (k + 1)).val() == undefined ? 0 : $("#txtW" + (k + 1)).val().trim(),
                    Hip: $("#txtH" + (k + 1)).val() == undefined ? 0 : $("#txtH" + (k + 1)).val().trim(),
                    InchTrackerDate: $("#txtIDate" + (k + 1)).val() == undefined ? 0 : $("#txtIDate" + (k + 1)).val().trim(),
                }
                mytracker.UserTrackerInch.push(list1);


            }


           // alert("aa");
            //
            CommonAjaxMethod('Program/SaveTracker', mytracker, false, 'POST', function (response) {
                //
                alert('Record saved successfully!!!');

            });
        }
    }
    function MyEatingSmartTools(ctrl)
    {
         if (sessionStorage.getItem('IsFreeSession') == "false") {
            var selectedUserId = "@Request.QueryString["userId"].ToString()";
            if (selectedUserId != "") {
                sessionStorage.setItem('userId', selectedUserId);
            }
            ctrl.href = '@Url.Content("~/Home/MyEatingSmartTools?userId=")' + selectedUserId;
            ctrl.click();
        }
        else {
            alert("You dont have sufficient permission on it.")
        return false;}
    }

</script>

