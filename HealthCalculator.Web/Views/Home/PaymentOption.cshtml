@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Payment detail</title>
    <link href="~/css/hover-min.css" rel="stylesheet" type="text/css" />
    <link href="~/css/animate.min.css" rel="stylesheet" type="text/css" />
    <link href="~/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="~/css/style.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <div class="container-fluid flowerBg">
        <div class="row justify-content-center">
            <div class="col-12 col-md-12 col-lg-11">
                <div class="middleContent bg-gray shadow">
                    <form class="form-data">

                        <div class="row">
                            <div class="col-12 col-md-12">
                                <p class="semi mb-2 text-yellow">Payment Option</p>
                                <hr class="mt-0 mb-3 bg-dark" />
                                <input type="hidden" id="hdnTotalDoller" />
                                <input type="hidden" id="hdnTotalINR" />
                            </div>
                        </div>
                        <div class="form-group row">
                            @*<div class="col-12 col-md-12">
                                    <hr class="mt-0 mb-3 bg-dark" />
                                </div>*@
                            <div class="col-12 col-sm-12 text-right">
                                <div class="col-12 col-md-2">
                                    <table>
                                        <tr>
                                            <td>
                                                <a onclick="RedirectToPayment(this,'P')" target="_blank"><img src="@CommonMethods.ServerPath/img/Paypal.png" /></a>
                                            </td>
                                            <td>
                                                <a onclick="RedirectToPayment(this,'R')" target="_blank"><img src="@CommonMethods.ServerPath/img/RazorPay.png" /></a>
                                            </td>
                                        </tr>
                                    </table>

                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    @*<div id="paypal-button"></div>
    <button id="rzp-button1">RazorPay</button>*@
    <script src="~/js/jquery-3.5.1.slim.min.js"></script>
    <script src="~/js/jquery-3.3.1.js"></script>
    <script src="~/js/jquery-3.5.1.min.js"></script>
    @*<script src="https://www.paypalobjects.com/api/checkout.js"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>*@
    @*<script>
        var orderId = "";
        var accountId = "";
        var amount = 0;

        var options = {
            "key": "rzp_test_dcqe3aqpMbfHdP", // Enter the Key ID generated from the Dashboard
            "amount": parseInt(sessionStorage.getItem("TotalINR"))*100, // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
            "currency": "INR",
            "name": "Eating Smart",
            "description": "Test Transaction",
            "image": "https://eatingsmart.in/HealthWeb//img/cart2.png",
            "order_id": orderId, //Pass the `id` obtained in the previous step
            //"account_id": "acc_Ef7ArAsdU5t0XL",
            "callback_url":  '@Url.Content("~/Payment/SuccessView")',
            "handler": function (response)
             {
                debugger;
                if (typeof response.razorpay_payment_id == 'undefined' || response.razorpay_payment_id < 1) {
                    redirect_url = '@Url.Content("~/Payment/SuccessView")';
                } else {
                    redirect_url = '@Url.Content("~/Payment/FailureView")';
                }
                location.href = redirect_url;

                alert(response.razorpay_payment_id);
                alert(response.razorpay_order_id);
                alert(response.razorpay_signature)
            }
        };
        var rzp1 = new Razorpay(options);
        document.getElementById('rzp-button1').onclick = function (e) {
            $.ajax({
                url: '/Payment/RazorOrder',
                method: 'POST',
                data: {
                    name: "gwalvanshi@gmail.com",
                    email: "gwalvanshi@gmail.com",
                    contactNumber: "9930016598",
                    address: "test",
                    amount: "100"
                },
                success: function (response) {
                    debugger;
                    orderId = response.orderId;
                    rzp1.open();
                    e.preventDefault();
                },
                error: function (jqXHR) {
                    debugger;
                    alert(jqXHR);
                }
            });

        }
    </script>*@
    <script>

        function RedirectToPayment(ctrl, strVar) {
            if (strVar == "R") {
                ctrl.href = '@Url.Content("~/Payment/Index?Id=")' + sessionStorage.getItem("TotalINR") + '&OrderId=' +sessionStorage.getItem("OrderId");
            }
            else {
                ctrl.href = '@Url.Content("~/Payment/PaymentWithPaypal?Id=")' + sessionStorage.getItem("TotalDoller") + '&OrderId=' + sessionStorage.getItem("OrderId");

            }
            ctrl.click();
        }


        //paypal.Button.render({
        //    // Configure environment
        //    env: 'sandbox',
        //    client: {
        //        sandbox: 'AQLwmegUd0MQ0Gz6XPU54XoBFgNH8xB0dKhnOiYzGaVGs9V8oC1i4PxZsvNlBqpX-VTk8waIMJYLhZnv',
        //        production: 'EGeUSBTdsd5Bp46pKw0GvBAskPe55rcTH3Tn62Im6U9bKdkr78o2yzsMHe_KBpk9VgFqJO9xOLDlepIo'
        //    },
        //    // Customize button (optional)
        //    locale: 'en_US',
        //    style: {
        //        size: 'small',
        //        color: 'gold',
        //        shape: 'pill',
        //    },

        //    // Enable Pay Now checkout flow (optional)
        //    commit: true,

        //    // Set up a payment
        //    payment: function (data, actions) {
        //        return actions.payment.create({
        //            transactions: [{
        //                amount: {
        //                    total: sessionStorage.getItem("TotalDoller"),
        //                    currency: 'USD'
        //                }
        //            }]
        //        });
        //    },
        //    // Execute the payment
        //    onAuthorize: function (data, actions) {
        //        return actions.payment.execute().then(function ()
        //        {
        //            debugger;
        //            // Show a confirmation message to the buyer
        //            window.alert('Thank you for your purchase!');
        //        });
        //    }
        //}, '#paypal-button');

    </script>

</body>
</html>
